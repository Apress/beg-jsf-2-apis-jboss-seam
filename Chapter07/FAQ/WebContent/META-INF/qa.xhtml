<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:a4j="http://richfaces.org/a4j"
    xmlns:rich="http://richfaces.org/rich"
    xmlns:ui="http://java.sun.com/jsf/facelets">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Insert title here</title>
</head>
<body>
<ui:component>
<h:form>
    <a4j:commandLink action="#{question.trigger}"
        value="#{question.questionText} (#{question.rating})"
        reRender="p" id="q" />
    <a href="javascript:Richfaces.showModalPanel('myDialog')">Rate</a>
</h:form>    
<rich:modalPanel id="myDialog" width="200" height="140">
    <f:facet name="header">
        <h:outputText value="Enter a rating"></h:outputText>
    </f:facet>
    <h:panelGroup id="mp">
        <h:messages id="m" />
    </h:panelGroup>
    <h:form style="float:right">
        <h:inputText size="2" value="#{question.rating}"/>
        <a4j:commandButton
            value="Rate"
            action="#{question.rate}"
            reRender="q,mp"
            oncomplete="if (document.getElementById('m')==null) Richfaces.hideModalPanel('myDialog')">
        </a4j:commandButton>
    </h:form>
</rich:modalPanel>
<br />
<h:panelGroup id="p">
    <h:outputText value="#{question.answerText}" id="a"
        rendered="#{question.showingAnswer}" />
</h:panelGroup>
</ui:component>
</body>
</html>